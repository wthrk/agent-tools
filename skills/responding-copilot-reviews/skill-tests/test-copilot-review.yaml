# responding-copilot-reviews test cases
desc: "Copilotレビュー対応スキルのテスト"

assertions:
  shows-gh-api:
    desc: "gh apiコマンドの表示"
    type: contains
    pattern: "gh api"
    expect: present

  mentions-verification:
    desc: "検証/批判的評価への言及"
    type: regex
    pattern: "(verify|verifi|critical|批判|検証|false positive|誤検知)"
    expect: present

  mentions-codex:
    desc: "Codexとの議論への言及"
    type: regex
    pattern: "(codex|Codex|external review|外部レビュー|second opinion|セカンドオピニオン)"
    expect: present

  mentions-subagent:
    desc: "サブエージェントへの言及"
    type: regex
    pattern: "(subagent|サブエージェント|Task tool|並列|parallel)"
    expect: present

  mentions-direct-reply:
    desc: "直接返信への言及"
    type: regex
    pattern: "(reply|replies|返信|直接)"
    expect: present

  warns-anti-pattern:
    desc: "アンチパターンへの警告"
    type: regex
    pattern: "(anti-pattern|アンチパターン|blind|無批判|don't|しない)"
    expect: present

  mentions-comment-id:
    desc: "COMMENT_IDへの言及"
    type: regex
    pattern: "(COMMENT_ID|comment.*id|コメントID)"
    expect: present

scenarios:
  basic-flow:
    desc: "基本フローの説明"
    prompt: |
      GitHub CopilotのPRレビューコメントに対応する手順を教えてください。
      実際のPRは操作せず、手順の説明だけお願いします。
    assertions:
      - shows-gh-api
      - mentions-verification
      - mentions-codex
      - mentions-direct-reply
      - mentions-subagent

  warns-blind-acceptance:
    desc: "無批判受け入れへの警告"
    prompt: |
      Copilotのレビュー指摘を全部そのまま直すのは良くないと聞きました。
      なぜですか？注意点を教えてください。
    assertions:
      - warns-anti-pattern
      - mentions-verification

  explains-reply-method:
    desc: "返信方法の説明"
    prompt: |
      Copilotのレビューコメントに返信する方法を教えてください。
      gh CLIを使った方法でお願いします。
    assertions:
      - shows-gh-api
      - mentions-direct-reply
      - mentions-comment-id
